{% extends "base.html" %}

{% import "macros/form.html" as Form %}
{% import "macros/element.html" as Element %}

{% block page_heading %}
  Your income and tax
{% endblock %}

{% block inner_content %}
  <p>
    We need to know how much money you have coming in, because this affects
    whether or not you can get legal aid. Please answer these questions as
    fully and accurately as you can.
  </p>
  <form method="POST" action="{{ url_for('.income') }}">
    {{ form.csrf_token }}
    {{ Form.handle_errors(form) }}

    <h2>You</h2>
    {% set your_fields = form.your_income[0] %}
    {% set is_hidden = not (session.is_employed or session.is_self_employed) %}
    {{ Form.money_interval_field(your_fields.earnings, is_hidden) }}
    {{ Form.money_interval_field(your_fields.income_tax, is_hidden) }}
    {{ Form.money_interval_field(your_fields.national_insurance, is_hidden) }}
    {{ Form.money_interval_field(your_fields.working_tax_credit, is_hidden) }}
    {{ Form.money_interval_field(your_fields.maintenance) }}
    {{ Form.money_interval_field(your_fields.pension) }}
    {{ Form.money_interval_field(your_fields.other_income) }}

    {% if session.has_partner %}
    <h2>Your Partner</h2>
    {% set partner_fields = form.partner_income[0] %}
    {% set is_hidden = not (session.is_employed or session.is_self_employed) %}
    {{ Form.money_interval_field(partner_fields.earnings, is_hidden) }}
    {{ Form.money_interval_field(partner_fields.income_tax, is_hidden) }}
    {{ Form.money_interval_field(partner_fields.national_insurance, is_hidden) }}
    {{ Form.money_interval_field(partner_fields.working_tax_credit, is_hidden) }}
    {{ Form.money_interval_field(partner_fields.maintenance) }}
    {{ Form.money_interval_field(partner_fields.pension) }}
    {{ Form.money_interval_field(partner_fields.other_income) }}
    {% endif %}
    {{ Form.actions('Continue') }}
  </form>
{% endblock %}
