{% extends "checker/base.html" %}{% load i18n helpers pdb %}

{% block page_header %}
  <h1>{% trans "Your details" %}</h1>
{% endblock %}

{% block checker_content %}
  <form action="." method="POST">
    {% csrf_token %}

    {{ wizard.management_form }}
    
    {% if form.errors %}
      <div class="ErrorSummary" role="alert" aria-labelledby="error-heading" tabindex="-1">
        <h2 class="ErrorSummary-heading" id="error-heading">There was a problem submitting the form</h2>
        <p>Because of the following problems:</p>
        <ol class="ErrorSummary-list">
          {% for field, errors in form.errors.items %}
            {% with field_obj=form|field_from_name:field %}
            <li class="ErrorSummary-listItem"><a href="#{{ field_obj.auto_id }}-label">              
              {{ field_obj.label }}
              {% for error in errors %}
                {% if not forloop.first  %}
                  and
                {% endif %}
                {{ error }}
              {% endfor %}
            </a></li>
            {% endwith %}
          {% endfor %}
        </ol>
      </div>
    {% endif %}
    
    {% for field in form %}
      <div class="FormRow cf{% if field.help_text %} FormRow--details{% endif %}{% if field.errors %} Error{% endif %}" role="radiogroup" aria-labelledby="{{ field.auto_id }}-label">
        <p class="FormRow-label" id="{{ field.auto_id }}-label">
          {{ field.label }}
          {% for error in field.errors %}
            <span class="Error-message">{{ error }}</span>
          {% endfor %}
        </p>
        
        {% if field.help_text %}
        <details>
          <summary>{% trans "More info" %}</summary>
          <div>
            {{ field.help_text|safe }}
          </div>
        </details>
        {% endif %}

        {% for choice in field.field.choices %}
        <label for="{{ field.auto_id }}_{{ forloop.counter0 }}" class="FormRow-option">
          <input type="radio" name="{{ field.html_name }}" id="{{ field.auto_id }}_{{ forloop.counter0 }}" value="{{ choice.0 }}"{% if field.value|stringformat:"s" == choice.0|stringformat:"s" %} checked="checked"{% endif %}>
          {{ choice.1 }}
        </label>
        {% endfor %}
      </div>
    {% endfor %}

    <div class="FormActions">
      <button type="submit" class="Button">{% trans "Next step - Your finances" %}</button>
      <a href="{% url 'checker:checker_step' wizard.steps.prev %}">{% trans "Go back to previous step" %}</a>
    </div>
  </form>

{% endblock %}